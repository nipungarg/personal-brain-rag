# Render Blueprint: deploy the RAG Gradio app as a Web Service.
# Docs: https://render.com/docs/blueprint-spec
#
# 1. Connect this repo in Render Dashboard.
# 2. Add env var OPENAI_API_KEY (Secret) in the service.
# 3. Optional: add a Persistent Disk and set DISK_PATH; then set CHROMA_PERSIST_DIR, etc. to paths on the disk so data survives deploys.
# 4. Deploy.

services:
  - type: web
    name: personal-brain-rag
    runtime: python
    region: oregon  # or singapore, frankfurt
    plan: free  # or starter for persistent disk

    buildCommand: pip install -r requirements.txt
    startCommand: python run_server.py

    envVars:
      - key: PYTHON_VERSION
        value: "3.11.11"  # match local; Render uses this for build
      - key: OPENAI_API_KEY
        sync: false  # set manually as Secret in Dashboard
      - key: SERVER_HOST
        value: 0.0.0.0
      # PORT is set by Render automatically
      - key: LOG_LEVEL
        value: INFO

    # Optional: uncomment and attach a Persistent Disk in Dashboard, then set CHROMA_PERSIST_DIR to /data/chroma_db etc.
    # disk:
    #   name: rag-data
    #   mountPath: /data
    #   sizeGB: 1
